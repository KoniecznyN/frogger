(()=>{"use strict";const t=function(t,r,n,e,o){this.x=t,this.y=r,this.w=n,this.h=e,this.color=o};var r,n=(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),e=function(t){function r(r,n,e,o,i,s,a){var c=t.call(this,r,n,e,o,i)||this;return c.isAlive=!0,c.direction=s,c.speed=a,c}return n(r,t),r.prototype.move=function(t){this.destroy(),this.x+=this.direction*this.speed*(t/1e3)},r.prototype.destroy=function(){1==this.direction?this.x>=700&&(this.isAlive=!1):this.x<=-100&&(this.isAlive=!1)},r.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},r}(t);const o=e;var i=function(){var t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},t(r,n)};return function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),s=function(t){function r(r,n,e,o,i){var s=t.call(this,r,n,e,o,i)||this;return s.configureMove(),s}return i(r,t),r.prototype.configureMove=function(){var t=this;window.addEventListener("keydown",(function(r){"ArrowUp"==r.key&&t.y>0&&(t.y-=50),"ArrowDown"==r.key&&t.y<650&&(t.y+=50),"ArrowRight"==r.key&&t.x<650&&(t.x+=50),"ArrowLeft"==r.key&&t.x>0&&(t.x-=50)}))},r.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},r.prototype.die=function(){this.x=350,this.y=650},r}(t);const a=new s(350,650,50,50,"green");var c=function(t,r,n,e){return new(n||(n=Promise))((function(o,i){function s(t){try{c(e.next(t))}catch(t){i(t)}}function a(t){try{c(e.throw(t))}catch(t){i(t)}}function c(t){var r;t.done?o(t.value):(r=t.value,r instanceof n?r:new n((function(t){t(r)}))).then(s,a)}c((e=e.apply(t,r||[])).next())}))},u=function(t,r){var n,e,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,e&&(o=2&a[0]?e.return:a[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,a[1])).done)return o;switch(e=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,e=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(t,i)}catch(t){a=[6,t],e=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},f=document.getElementById("canvas"),h=f.getContext("2d");(new(function(){function t(){var t=this;this.frameRate=1e3/60,this.lastFrame=0,this.carSpawnTimer={first:0,second:0,third:0,fourth:0,fifth:0},this.spawnIndex={first:0,second:0,third:0,fourth:0,fifth:0},this.cars=[],this.frog=a,this.receiveCarsData=function(){return c(t,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,fetch("../scripts/rows.json")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},this.gameLoop=function(r){var n=0;if(void 0===t.startTime)t.startTime=r;else{var e=Math.round((r-t.startTime)/t.frameRate);for(var o in n=(e-t.lastFrame)*t.frameRate,t.carSpawnTimer)t.carSpawnTimer[o]+=n;t.lastFrame=e}t.spawnCars("first",{x:-100,y:600},1,100),t.spawnCars("second",{x:700,y:550},-1,120),t.spawnCars("third",{x:-100,y:500},1,130),t.spawnCars("fourth",{x:700,y:450},-1,100),t.spawnCars("fifth",{x:-100,y:400},1,120),t.cars=t.cars.filter((function(t){return t.isAlive})),h.clearRect(0,0,f.width,f.height),t.cars.forEach((function(t){t.move(n)})),t.checkCollisions(),t.draw(),requestAnimationFrame(t.gameLoop)}}return t.prototype.init=function(){return c(this,void 0,void 0,(function(){var t;return u(this,(function(r){switch(r.label){case 0:return console.log("start"),t=this,[4,this.receiveCarsData()];case 1:return t.carsData=r.sent(),this.configureCanvas(),requestAnimationFrame(this.gameLoop),[2]}}))}))},t.prototype.configureCanvas=function(){f.width=700,f.height=700,h.fillStyle="red",h.fillRect(0,0,f.width,f.height)},t.prototype.draw=function(){this.cars.forEach((function(t){t.draw(h)})),this.frog.draw(h)},t.prototype.checkCollisions=function(){var t=this;this.cars.forEach((function(r){t.frog.x<r.x+r.w&&t.frog.x+t.frog.w>r.x&&t.frog.y<r.y+r.h&&t.frog.y+t.frog.h>r.y&&t.frog.die()}))},t.prototype.spawnCars=function(t,r,n,e){this.carSpawnTimer[t]>=this.carsData[t][this.spawnIndex[t]]&&(this.cars.push(new o(r.x,r.y,100,50,"black",n,e)),this.carSpawnTimer[t]-=this.carsData[t][this.spawnIndex[t]],this.spawnIndex[t]+=1,5==this.spawnIndex[t]&&(this.spawnIndex[t]=0))},t}())).init()})();