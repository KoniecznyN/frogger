(()=>{"use strict";const t=function(t,n,r,e,o){this.x=t,this.y=n,this.w=r,this.h=e,this.color=o};var n,r=(n=function(t,r){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},n(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=t}n(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}),e=function(t){function n(n,r,e,o,i,s,c){var a=t.call(this,n,r,e,o,i)||this;return a.isAlive=!0,a.direction=s,a.speed=c,a}return r(n,t),n.prototype.move=function(t){this.destroy(),this.x+=this.direction*this.speed*(t/1e3)},n.prototype.checkCollisions=function(t){t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y&&t.die()},n.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},n.prototype.destroy=function(){1==this.direction?this.x>=700&&(this.isAlive=!1):this.x<=-this.w&&(this.isAlive=!1)},n}(t);const o=e;var i=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),s=function(t){function n(n,r,e,o,i,s,c){var a=t.call(this,n,r,e,o,i)||this;return a.isAlive=!0,a.direction=s,a.speed=c,a}return i(n,t),n.prototype.move=function(t){this.destroy(),this.x+=this.direction*this.speed*(t/1e3)},n.prototype.checkCollisions=function(t,n){t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y&&t.follow(n,this.direction,this.speed)},n.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},n.prototype.destroy=function(){this.x<=-this.w&&(this.isAlive=!1)},n}(t);const c=s;var a=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),h=function(t){function n(n,r,e,o,i){var s=t.call(this,n,r,e,o,i)||this;return s.onPlatform=!1,s.configureMove(),s}return a(n,t),n.prototype.configureMove=function(){var t=this;window.addEventListener("keydown",(function(n){"ArrowUp"==n.key&&t.y>0&&(t.y-=50),"ArrowDown"==n.key&&t.y<650&&(t.y+=50),"ArrowRight"==n.key&&t.x<650&&(t.x+=50),"ArrowLeft"==n.key&&t.x>0&&(t.x-=50)}))},n.prototype.follow=function(t,n,r){this.x+=n*r*(t/1e3)},n.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},n.prototype.die=function(){this.x=350,this.y=650},n}(t),f=new h(350,650,50,50,"green"),l=function(){var t=function(n,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},t(n,r)};return function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=n}t(n,r),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),u=function(t){function n(n,r,e,o,i){return t.call(this,n,r,e,o,i)||this}return l(n,t),n.prototype.checkCollisions=function(t){t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y&&t.die()},n.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},n}(t);const p=new u(0,100,700,250,"blue");var w=function(t,n,r,e){return new(r||(r=Promise))((function(o,i){function s(t){try{a(e.next(t))}catch(t){i(t)}}function c(t){try{a(e.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(s,c)}a((e=e.apply(t,n||[])).next())}))},y=function(t,n){var r,e,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(c){return function(a){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(i=0)),i;)try{if(r=1,e&&(o=2&c[0]?e.return:c[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,c[1])).done)return o;switch(e=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,e=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=n.call(t,i)}catch(t){c=[6,t],e=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}},d=document.getElementById("canvas"),v=d.getContext("2d");(new(function(){function t(){var t=this;this.frameRate=1e3/60,this.lastFrame=0,this.carSpawnTimer={first:0,second:0,third:0,fourth:0,fifth:0},this.carSpawnIndex={first:0,second:0,third:0,fourth:0,fifth:0},this.cars=[],this.flowersSpawnTimer={first:0,second:0},this.flowersSpawnIndex={first:0,second:0},this.flowers=[],this.frog=f,this.frogOnPlatform=!1,this.deadZone=p,this.receiveCarsData=function(){return w(t,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,fetch("../data/cars.json")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},this.receiveFlowersData=function(){return w(t,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,fetch("../data/flowers.json")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},this.gameLoop=function(n){var r=0;if(void 0===t.startTime)t.startTime=n;else{var e=Math.round((n-t.startTime)/t.frameRate);for(var o in r=(e-t.lastFrame)*t.frameRate,t.carSpawnTimer)t.carSpawnTimer[o]+=r;for(var o in t.flowersSpawnTimer)t.flowersSpawnTimer[o]+=r;t.lastFrame=e}t.spawnCars("first",{x:-100,y:600},1,100),t.spawnCars("second",{x:700,y:550},-1,120),t.spawnCars("third",{x:-100,y:500},1,130),t.spawnCars("fourth",{x:700,y:450},-1,100),t.spawnCars("fifth",{x:-100,y:400},1,120),t.cars=t.cars.filter((function(t){return t.isAlive})),t.spawnFlowers("first",{x:700,y:300},150,150),t.spawnFlowers("second",{x:700,y:150},100,150),t.flowers=t.flowers.filter((function(t){return t.isAlive})),v.clearRect(0,0,d.width,d.height),t.checkCollisions(r),t.cars.forEach((function(t){t.move(r)})),t.flowers.forEach((function(t){t.move(r)})),t.draw(),requestAnimationFrame(t.gameLoop)}}return t.prototype.init=function(){return w(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return console.log("start"),t=this,[4,this.receiveCarsData()];case 1:return t.carsData=r.sent(),n=this,[4,this.receiveFlowersData()];case 2:return n.flowersData=r.sent(),this.configureCanvas(),requestAnimationFrame(this.gameLoop),[2]}}))}))},t.prototype.configureCanvas=function(){d.width=700,d.height=700,v.fillStyle="red",v.fillRect(0,0,d.width,d.height)},t.prototype.draw=function(){this.deadZone.draw(v),this.cars.forEach((function(t){t.draw(v)})),this.flowers.forEach((function(t){t.draw(v)})),this.frog.draw(v)},t.prototype.checkCollisions=function(t){var n=this;this.cars.forEach((function(t){t.checkCollisions(n.frog)})),this.flowers.forEach((function(r){r.checkCollisions(n.frog,t)}))},t.prototype.spawnCars=function(t,n,r,e){this.carSpawnTimer[t]>=this.carsData[t][this.carSpawnIndex[t]]&&(this.cars.push(new o(n.x,n.y,100,50,"black",r,e)),this.carSpawnTimer[t]-=this.carsData[t][this.carSpawnIndex[t]],this.carSpawnIndex[t]+=1,5==this.carSpawnIndex[t]&&(this.carSpawnIndex[t]=0))},t.prototype.spawnFlowers=function(t,n,r,e){this.flowersSpawnTimer[t]>=this.flowersData[t][this.flowersSpawnIndex[t]]&&(this.flowers.push(new c(n.x,n.y,r,50,"pink",-1,e)),this.flowersSpawnTimer[t]-=this.flowersData[t][this.flowersSpawnIndex[t]],this.flowersSpawnIndex[t]+=1,4==this.flowersSpawnIndex[t]&&(this.flowersSpawnIndex[t]=0))},t}())).init()})();