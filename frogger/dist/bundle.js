(()=>{"use strict";const t=function(t,o,n,r,i){this.x=t,this.y=o,this.w=n,this.h=r,this.color=i};var o,n=(o=function(t,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},o(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),r=function(t){function o(o,n,r,i,e,s,c){var a=t.call(this,o,n,r,i,e)||this;return a.isAlive=!0,a.direction=s,a.speed=c,a}return n(o,t),o.prototype.move=function(t){this.destroy(),this.x+=this.direction*this.speed*(t/1e3)},o.prototype.checkCollisions=function(t){t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y&&t.die()},o.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},o.prototype.destroy=function(){1==this.direction?this.x>=700&&(this.isAlive=!1):this.x<=-this.w&&(this.isAlive=!1)},o}(t);const i=r;var e=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function o(o,n,r,i,e,s,c){var a=t.call(this,o,n,r,i,e)||this;return a.isAlive=!0,a.direction=s,a.speed=c,a}return e(o,t),o.prototype.move=function(t){this.destroy(),this.x+=this.direction*this.speed*(t/1e3)},o.prototype.checkCollisions=function(t,o){var n=t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y;return n&&t.follow(o,this.direction,this.speed),n},o.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},o.prototype.destroy=function(){this.x<=-this.w&&(this.isAlive=!1)},o}(t);const c=s;var a=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function o(o,n,r,i,e,s,c){var a=t.call(this,o,n,r,i,e)||this;return a.isAlive=!0,a.direction=s,a.speed=c,a}return a(o,t),o.prototype.move=function(t){this.destroy(),this.x+=this.direction*this.speed*(t/1e3)},o.prototype.checkCollisions=function(t,o){var n=t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y;return n&&t.follow(o,this.direction,this.speed),n},o.prototype.destroy=function(){1==this.direction?this.x>=700&&(this.isAlive=!1):this.x<=-100&&(this.isAlive=!1)},o.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},o}(t);const f=h;var l=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function o(o,n,r,i,e){var s=t.call(this,o,n,r,i,e)||this;return s.onPlatform=!1,s.configureMove(),s}return l(o,t),o.prototype.configureMove=function(){var t=this;window.addEventListener("keydown",(function(o){"ArrowUp"==o.key&&t.y>0&&(t.y-=50),"ArrowDown"==o.key&&t.y<650&&(t.y+=50),"ArrowRight"==o.key&&t.x<650&&(t.x+=50),"ArrowLeft"==o.key&&t.x>0&&(t.x-=50)}))},o.prototype.follow=function(t,o,n){this.x+=o*n*(t/1e3)},o.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},o.prototype.die=function(){this.x=350,this.y=650},o}(t),p=new u(350,650,50,50,"green"),w=function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function o(o,n,r,i,e){return t.call(this,o,n,r,i,e)||this}return w(o,t),o.prototype.checkCollisions=function(t){t.x<this.x+this.w&&t.x+t.w>this.x&&t.y<this.y+this.h&&t.y+t.h>this.y&&t.die()},o.prototype.draw=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.w,this.h)},o}(t);const d=new y(0,100,700,250,"blue");var x=function(t,o,n,r){return new(n||(n=Promise))((function(i,e){function s(t){try{a(r.next(t))}catch(t){e(t)}}function c(t){try{a(r.throw(t))}catch(t){e(t)}}function a(t){var o;t.done?i(t.value):(o=t.value,o instanceof n?o:new n((function(t){t(o)}))).then(s,c)}a((r=r.apply(t,o||[])).next())}))},v=function(t,o){var n,r,i,e={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(e=0)),e;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,r=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(!((i=(i=e.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){e=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){e.label=c[1];break}if(6===c[0]&&e.label<i[1]){e.label=i[1],i=c;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(c);break}i[2]&&e.ops.pop(),e.trys.pop();continue}c=o.call(t,e)}catch(t){c=[6,t],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}},m=document.getElementById("canvas"),S=m.getContext("2d");(new(function(){function t(){var t=this;this.frameRate=1e3/60,this.lastFrame=0,this.carSpawnTimer={first:0,second:0,third:0,fourth:0,fifth:0},this.carSpawnIndex={first:0,second:0,third:0,fourth:0,fifth:0},this.cars=[],this.flowersSpawnTimer={first:0,second:0},this.flowersSpawnIndex={first:0,second:0},this.flowers=[],this.woodSpawnTimer={first:0,second:0,third:0,fourth:0,fifth:0},this.woodSpawnIndex={first:0,second:0,third:0,fourth:0,fifth:0},this.woods=[],this.frog=p,this.deadZone=d,this.receiveData=function(o){return x(t,void 0,void 0,(function(){return v(this,(function(t){switch(t.label){case 0:return[4,fetch("../data/".concat(o,".json"))];case 1:return[4,t.sent().json()];case 2:return[2,t.sent()]}}))}))},this.gameLoop=function(o){var n=0;if(void 0===t.startTime)t.startTime=o;else{var r=Math.round((o-t.startTime)/t.frameRate);for(var i in n=(r-t.lastFrame)*t.frameRate,t.carSpawnTimer)t.carSpawnTimer[i]+=n;for(var i in t.flowersSpawnTimer)t.flowersSpawnTimer[i]+=n;for(var i in t.woodSpawnTimer)t.woodSpawnTimer[i]+=n;t.lastFrame=r}t.spawnCars("first",{x:-100,y:600},1,100),t.spawnCars("second",{x:700,y:550},-1,120),t.spawnCars("third",{x:-100,y:500},1,130),t.spawnCars("fourth",{x:700,y:450},-1,100),t.spawnCars("fifth",{x:-100,y:400},1,120),t.cars=t.cars.filter((function(t){return t.isAlive})),t.spawnFlowers("first",{x:700,y:300},150,150),t.spawnFlowers("second",{x:700,y:150},100,150),t.flowers=t.flowers.filter((function(t){return t.isAlive})),t.spawnWood("first",{x:-150,y:250},150,150),t.spawnWood("second",{x:-350,y:200},350,170),t.spawnWood("third",{x:-200,y:100},200,150),t.flowers=t.flowers.filter((function(t){return t.isAlive})),S.clearRect(0,0,m.width,m.height),t.checkCollisions(n),t.cars.forEach((function(t){t.move(n)})),t.flowers.forEach((function(t){t.move(n)})),t.woods.forEach((function(t){t.move(n)})),t.draw(),requestAnimationFrame(t.gameLoop)}}return t.prototype.init=function(){return x(this,void 0,void 0,(function(){var t,o,n;return v(this,(function(r){switch(r.label){case 0:return console.log("start"),t=this,[4,this.receiveData("cars")];case 1:return t.carsData=r.sent(),o=this,[4,this.receiveData("flowers")];case 2:return o.flowersData=r.sent(),n=this,[4,this.receiveData("woods")];case 3:return n.woodsData=r.sent(),this.configureCanvas(),requestAnimationFrame(this.gameLoop),[2]}}))}))},t.prototype.configureCanvas=function(){m.width=700,m.height=700,S.fillStyle="red",S.fillRect(0,0,m.width,m.height)},t.prototype.draw=function(){this.deadZone.draw(S),this.cars.forEach((function(t){t.draw(S)})),this.flowers.forEach((function(t){t.draw(S)})),this.woods.forEach((function(t){t.draw(S)})),this.frog.draw(S)},t.prototype.checkCollisions=function(t){var o=this;this.cars.forEach((function(t){t.checkCollisions(o.frog)}));for(var n=0;n<this.flowers.length;n++){if(this.flowers[n].checkCollisions(this.frog,t)){this.frog.onPlatform=!0;break}this.frog.onPlatform=!1}if(!this.frog.onPlatform)for(n=0;n<this.woods.length;n++){if(this.woods[n].checkCollisions(this.frog,t)){this.frog.onPlatform=!0;break}this.frog.onPlatform=!1}this.frog.onPlatform||this.deadZone.checkCollisions(this.frog)},t.prototype.spawnCars=function(t,o,n,r){this.carSpawnTimer[t]>=this.carsData[t][this.carSpawnIndex[t]]&&(this.cars.push(new i(o.x,o.y,100,50,"black",n,r)),this.carSpawnTimer[t]-=this.carsData[t][this.carSpawnIndex[t]],this.carSpawnIndex[t]+=1,5==this.carSpawnIndex[t]&&(this.carSpawnIndex[t]=0))},t.prototype.spawnFlowers=function(t,o,n,r){this.flowersSpawnTimer[t]>=this.flowersData[t][this.flowersSpawnIndex[t]]&&(this.flowers.push(new c(o.x,o.y,n,50,"pink",-1,r)),this.flowersSpawnTimer[t]-=this.flowersData[t][this.flowersSpawnIndex[t]],this.flowersSpawnIndex[t]+=1,4==this.flowersSpawnIndex[t]&&(this.flowersSpawnIndex[t]=0))},t.prototype.spawnWood=function(t,o,n,r){this.woodSpawnTimer[t]>=this.woodsData[t][this.woodSpawnIndex[t]]&&(this.woods.push(new f(o.x,o.y,n,50,"brown",1,r)),this.woodSpawnTimer[t]-=this.woodsData[t][this.woodSpawnIndex[t]],this.woodSpawnIndex[t]+=1,3==this.woodSpawnIndex[t]&&(this.woodSpawnIndex[t]=0))},t}())).init()})();